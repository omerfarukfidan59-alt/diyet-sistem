{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GamerPC/OneDrive/Desktop/diyet-sistem/utils/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n\r\n// Bu instance, sadece anonim veya login olmuş kullanıcıların erişebileceği yetkilerle çalışır (Row Level Security - RLS kurallarına uyar)\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAGC,MAAM,WAAW,IAAA,8LAAY,EAAC,aAAa"}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/GamerPC/OneDrive/Desktop/diyet-sistem/app/admin/clients/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { supabase } from \"../../../utils/supabase\";\r\n\r\nexport default function ClientsPage() {\r\n    const [clients, setClients] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetchClients();\r\n    }, []);\r\n\r\n    async function fetchClients() {\r\n        setLoading(true);\r\n        const { data, error } = await supabase\r\n            .from('profiles')\r\n            .select('*')\r\n            .eq('role', 'client')\r\n            .order('created_at', { ascending: false });\r\n\r\n        if (!error && data) {\r\n            setClients(data);\r\n        }\r\n        setLoading(false);\r\n    }\r\n\r\n    const handleDeleteClient = async (clientId: string, clientName: string) => {\r\n        if (!window.confirm(`${clientName} isimli danışanı silmek istediğinize emin misiniz? Bu işlem geri alınamaz ve o kişiye ait tüm veriler (diyet, gelişim, kilo, giriş hesabı) kalıcı olarak silinir.`)) return;\r\n\r\n        // Yerel verileri temizle (Güvenlik amaçlı)\r\n        localStorage.removeItem(`diet_${clientId}`);\r\n        localStorage.removeItem(`dietProgress_${clientId}`);\r\n        localStorage.removeItem(`weightLogs_${clientId}`);\r\n\r\n        // Supabase Silme İşlemi (DB tarafındaki CASCADE ve TRIGGER sayesinde her şeyi siler)\r\n        const { error, count } = await supabase\r\n            .from('profiles')\r\n            .delete({ count: 'exact' })\r\n            .eq('id', clientId);\r\n\r\n        if (error) {\r\n            console.error(\"Silme hatası:\", error);\r\n            alert(\"Silme işlemi başarısız: \" + error.message);\r\n        } else if (count === 0) {\r\n            alert(\"Uyarı: Kullanıcı veritabanında bulunamadı veya silme izniniz yok (RLS). Lütfen SQL politikalarını kontrol edin.\");\r\n        } else {\r\n            // Arayüzden kaldır\r\n            setClients(clients.filter(c => c.id !== clientId));\r\n            alert(\"Danışan ve tüm verileri başarıyla silindi.\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{ minHeight: \"100vh\", background: \"#f4f7f4\", display: \"flex\", fontFamily: \"var(--font-body)\" }}>\r\n\r\n            {/* Admin Sidebar */}\r\n            <div style={{ width: \"280px\", background: \"#2c3e50\", color: \"white\", padding: \"40px 30px\", display: \"flex\", flexDirection: \"column\", gap: \"40px\" }}>\r\n                <div>\r\n                    <h2 style={{ fontSize: \"22px\", fontWeight: 800, color: \"#79a33d\" }}>Sümeyye Hanım</h2>\r\n                    <p style={{ fontSize: \"12px\", color: \"#bdc3c7\", marginTop: \"5px\" }}>Diyetisyen Admin Paneli</p>\r\n                </div>\r\n\r\n                <nav style={{ display: \"flex\", flexDirection: \"column\", gap: \"12px\" }}>\r\n                    <Link href=\"/admin\" style={navLink}>Genel Bakış</Link>\r\n                    <Link href=\"/admin/clients\" style={activeNavLink}>Danışan Yönetimi</Link>\r\n                    <Link href=\"/admin/food\" style={navLink}>Besin Kütüphanesi</Link>\r\n                    <Link href=\"/admin/appointments\" style={navLink}>Randevu Takvimi</Link>\r\n                    <Link href=\"/admin/reports\" style={navLink}>Raporlar</Link>\r\n                </nav>\r\n\r\n                <div style={{ marginTop: \"auto\" }}>\r\n                    <Link href=\"/\" style={{ color: \"#ecf0f1\", textDecoration: \"none\", fontSize: \"14px\", opacity: 0.8 }}>Oturumu Kapat</Link>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Main Content */}\r\n            <div style={{ flex: 1, padding: \"50px\", overflowY: \"auto\" }}>\r\n\r\n                <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: \"40px\" }}>\r\n                    <div>\r\n                        <h1 style={{ fontSize: \"32px\", fontWeight: 700, color: \"#2c3e50\" }}>Danışan Yönetimi</h1>\r\n                        <p style={{ color: \"#7f8c8d\" }}>Sisteme kayıtlı tüm danışanlarınızın listesi ve analiz verileri.</p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Clients Table */}\r\n                <div style={{ background: \"white\", borderRadius: \"20px\", overflow: \"hidden\", boxShadow: \"0 10px 20px rgba(0,0,0,0.02)\" }}>\r\n                    <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\r\n                        <thead style={{ background: \"#fcfdfe\" }}>\r\n                            <tr style={{ textAlign: \"left\" }}>\r\n                                <th style={thStyle}>Ad Soyad</th>\r\n                                <th style={thStyle}>Boy</th>\r\n                                <th style={thStyle}>Kilo</th>\r\n                                <th style={thStyle}>VKI</th>\r\n                                <th style={thStyle}>BMH</th>\r\n                                <th style={thStyle}>Hedef</th>\r\n                                <th style={thStyle}>İşlemler</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {loading ? (\r\n                                <tr>\r\n                                    <td colSpan={7} style={{ padding: \"50px\", textAlign: \"center\", color: \"#95a5a6\" }}>\r\n                                        Yükleniyor...\r\n                                    </td>\r\n                                </tr>\r\n                            ) : clients.length > 0 ? clients.map((client) => {\r\n                                const bmi = (Number(client.weight) / ((Number(client.height) / 100) ** 2)).toFixed(1);\r\n                                const clientAge = Number(client.age) || 30; // Varsayılan 30 yaş\r\n                                const bmh = Math.round(10 * Number(client.weight) + 6.25 * Number(client.height) - 5 * clientAge + 5);\r\n\r\n                                return (\r\n                                    <tr key={client.id} style={{ borderBottom: \"1px solid #f1f1f1\" }}>\r\n                                        <td style={tdStyle}>\r\n                                            <div style={{ fontWeight: 700, color: \"#2c3e50\" }}>{client.full_name}</div>\r\n                                            <div style={{ fontSize: \"12px\", color: \"#95a5a6\" }}>{client.height} cm | {client.weight} kg</div>\r\n                                        </td>\r\n                                        <td style={tdStyle}>{client.height} cm</td>\r\n                                        <td style={tdStyle}>{client.weight} kg</td>\r\n                                        <td style={tdStyle}>\r\n                                            <span style={{\r\n                                                background: \"#f1f1f1\",\r\n                                                padding: \"4px 10px\",\r\n                                                borderRadius: \"20px\",\r\n                                                fontSize: \"13px\",\r\n                                                fontWeight: 600\r\n                                            }}>{bmi}</span>\r\n                                        </td>\r\n                                        <td style={tdStyle}>\r\n                                            <span style={{\r\n                                                background: \"#f8f9fa\",\r\n                                                color: \"#e67e22\",\r\n                                                padding: \"4px 10px\",\r\n                                                borderRadius: \"20px\",\r\n                                                fontSize: \"13px\",\r\n                                                fontWeight: 700\r\n                                            }}>{bmh} <span style={{ fontSize: \"10px\", color: \"#95a5a6\", fontWeight: \"normal\" }}>kcal</span></span>\r\n                                        </td>\r\n                                        <td style={tdStyle}>{client.target_weight} kg</td>\r\n                                        <td style={tdStyle}>\r\n                                            <div style={{ display: \"flex\", gap: \"10px\" }}>\r\n                                                <Link\r\n                                                    href={`/admin/clients/${client.id}/diet`}\r\n                                                    style={{\r\n                                                        textDecoration: \"none\",\r\n                                                        background: \"#79a33d\",\r\n                                                        color: \"white\",\r\n                                                        padding: \"8px 15px\",\r\n                                                        borderRadius: \"8px\",\r\n                                                        fontSize: \"13px\",\r\n                                                        fontWeight: 700\r\n                                                    }}\r\n                                                >\r\n                                                    Diyet Hazırla\r\n                                                </Link>\r\n                                                <button onClick={() => handleDeleteClient(client.id, client.full_name)} style={{ ...actionBtn, color: \"#e74c3c\", fontSize: \"14px\", fontWeight: \"bold\", padding: \"8px 15px\" }}>Sil</button>\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                );\r\n                            }) : (\r\n                                <tr>\r\n                                    <td colSpan={7} style={{ padding: \"50px\", textAlign: \"center\", color: \"#95a5a6\" }}>\r\n                                        Henüz kayıtlı danışan bulunmuyor.\r\n                                    </td>\r\n                                </tr>\r\n                            )}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst thStyle: React.CSSProperties = {\r\n    padding: \"20px\",\r\n    color: \"#95a5a6\",\r\n    fontSize: \"13px\",\r\n    textTransform: \"uppercase\",\r\n    letterSpacing: \"1px\",\r\n    fontWeight: 700\r\n};\r\n\r\nconst tdStyle: React.CSSProperties = {\r\n    padding: \"20px\",\r\n    color: \"#2c3e50\",\r\n    fontSize: \"15px\"\r\n};\r\n\r\nconst actionBtn: React.CSSProperties = {\r\n    background: \"none\",\r\n    border: \"none\",\r\n    cursor: \"pointer\",\r\n    fontSize: \"18px\",\r\n    padding: \"5px\",\r\n    borderRadius: \"5px\",\r\n    transition: \"background 0.3s\"\r\n};\r\n\r\nconst navLink: React.CSSProperties = {\r\n    padding: \"15px 20px\",\r\n    borderRadius: \"12px\",\r\n    color: \"#bdc3c7\",\r\n    textDecoration: \"none\",\r\n    fontSize: \"15px\",\r\n    transition: \"all 0.3s ease\",\r\n};\r\n\r\nconst activeNavLink: React.CSSProperties = {\r\n    ...navLink,\r\n    background: \"#34495e\",\r\n    color: \"white\",\r\n    fontWeight: 700\r\n};\r\n"],"names":[],"mappings":"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"}}]
}