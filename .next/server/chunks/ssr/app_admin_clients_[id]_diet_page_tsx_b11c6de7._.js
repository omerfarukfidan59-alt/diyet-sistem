module.exports=[9892,a=>{"use strict";var b=a.i(87924),c=a.i(31626),d=a.i(72131),e=a.i(38246),f=a.i(50944),g=a.i(64193);function h(a){if(!a||"string"!=typeof a)return null;let b=a.trim().replace(",",".").match(/^([\d.]+)\s*(.*)?$/);if(!b)return null;let c=parseFloat(b[1]);if(isNaN(c))return null;let d=(b[2]||"").toLowerCase().trim();return["g","gr","gram"].includes(d)?d="gram":["adet","tane"].includes(d)&&(d="adet"),{amount:c,unit:d}}function i(){let a=(0,f.useParams)(),i=(0,f.useRouter)(),m=a?.id,[n,o]=(0,d.useState)(null),[p,q]=(0,d.useState)(0),[r,s]=(0,d.useState)([]),[t,u]=(0,d.useState)({}),[v,w]=(0,d.useState)(!0),[x,y]=(0,d.useState)([{day:1,breakfast:[],lunch:[],dinner:[],snacks:[]}]);(0,d.useEffect)(()=>{m&&a();async function a(){w(!0);let{data:a}=await g.supabase.from("profiles").select("*").eq("id",m).single();a&&o(a);let{data:b}=await g.supabase.from("diets").select("*").eq("client_id",m).eq("is_active",!0).maybeSingle();b&&b.content&&y(b.content);let{data:c}=await g.supabase.from("food_library").select("*");c&&s(c);let{data:d}=await g.supabase.from("diet_progress").select("*").eq("client_id",m);if(d){let a={};d.forEach(b=>{a[b.day_number-1]={completed:b.is_completed,note:b.note}}),u(a)}w(!1)}},[m]);let z=(a,b,c,d)=>{y(e=>e.map((e,f)=>{if(f===p){let f=[...e[a]||[]];if(f[b]={...f[b],[c]:d},"portion"===c){let a=f[b].food,c=r.find(b=>b.name.toLowerCase()===String(a).toLowerCase());if(c){let a=function(a,b){if(!a||!b||!b.unit||void 0===b.cal)return null;let c=h(a),d=h(String(b.unit));if(!c||!d||0===d.amount)return null;let e=Number(b.cal);if(isNaN(e))return null;let f=!1;return(c.unit===d.unit||""===c.unit?f=!0:""===d.unit&&(f=!0),f)?Math.round(e*(c.amount/d.amount)):null}(String(d),c);null!==a&&(f[b].cal=a)}}return{...e,[a]:f}}return e}))},A=async()=>{if(!m)return;w(!0),await g.supabase.from("diets").update({is_active:!1}).eq("client_id",m);let{error:a}=await g.supabase.from("diets").insert([{client_id:m,title:`${x.length} G\xfcnl\xfck Program`,content:x,is_active:!0}]);a?alert("Diyet kaydedilemedi: "+a.message):(alert("Diyet listesi Supabase'e başarıyla kaydedildi!"),i.push("/admin/clients")),w(!1)};return v?(0,b.jsx)("div",{children:"Veriler yükleniyor..."}):n&&x[p]?(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},className:"jsx-11e0cc8a9ea0fe70 diet-page-wrapper",children:[(0,b.jsx)(c.default,{id:"11e0cc8a9ea0fe70",children:".diet-page-wrapper.jsx-11e0cc8a9ea0fe70{padding:50px}@media (width<=1024px){.diet-page-wrapper.jsx-11e0cc8a9ea0fe70{padding:20px}}"}),(0,b.jsxs)("div",{style:{marginBottom:"40px"},className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsx)(e.default,{href:"/admin/clients",style:{color:"#79a33d",textDecoration:"none",fontSize:"14px",fontWeight:700},children:"← Listeye Dön"}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px"},className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsxs)("div",{className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsxs)("h1",{style:{fontSize:"32px",fontWeight:700,color:"#2c3e50"},className:"jsx-11e0cc8a9ea0fe70",children:["Diyet Hazırla: ",n.name]}),(0,b.jsx)("p",{style:{color:"#7f8c8d"},className:"jsx-11e0cc8a9ea0fe70",children:"Danışan için öğün detaylarını gün gün planlayabilirsiniz."})]}),(0,b.jsxs)("button",{onClick:A,style:l,className:"jsx-11e0cc8a9ea0fe70",children:["Diyet Listesini ",x.length," Günlük Kaydet"]})]})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"25px",overflowX:"auto",paddingBottom:"10px"},className:"jsx-11e0cc8a9ea0fe70",children:[x.map((a,c)=>(0,b.jsxs)("div",{style:{position:"relative"},className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsxs)("button",{onClick:()=>q(c),style:{padding:"12px 25px",background:p===c?"#79a33d":"white",color:p===c?"white":"#2c3e50",border:`1px solid ${p===c?"#79a33d":"#e0e0e0"} `,borderRadius:"10px",fontWeight:700,cursor:"pointer",transition:"all 0.2s"},className:"jsx-11e0cc8a9ea0fe70",children:[c+1,". Gün"]}),x.length>1&&(0,b.jsx)("button",{onClick:()=>(a=>{if(1===x.length)return alert("En az 1 gün olmalı!");let b=x.filter((b,c)=>c!==a).map((a,b)=>({...a,day:b+1}));y(b),q(Math.min(p,b.length-1))})(c),style:{position:"absolute",top:"-8px",right:"-8px",background:"#e74c3c",color:"white",border:"none",borderRadius:"50%",width:"22px",height:"22px",fontSize:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Günü Sil",className:"jsx-11e0cc8a9ea0fe70",children:"X"})]},c)),(0,b.jsx)("button",{onClick:()=>{y([...x,{day:x.length+1,breakfast:[],lunch:[],dinner:[],snacks:[]}]),q(x.length)},style:{padding:"12px 25px",background:"transparent",color:"#79a33d",border:"2px dashed #79a33d",borderRadius:"10px",fontWeight:700,cursor:"pointer"},className:"jsx-11e0cc8a9ea0fe70",children:"+ Yeni Gün Ekle"})]}),(0,b.jsxs)("div",{style:{marginBottom:"30px",background:t[p]?.completed?"#eaf2e3":"white",padding:"20px 30px",borderRadius:"15px",border:`1px solid ${t[p]?.completed?"#79a33d":"#eee"} `,display:"flex",alignItems:"flex-start",gap:"20px"},className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsx)("div",{style:{fontSize:"24px",background:t[p]?.completed?"#79a33d":"#f0f0f0",color:t[p]?.completed?"white":"#ccc",width:"50px",height:"50px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},className:"jsx-11e0cc8a9ea0fe70",children:t[p]?.completed?"✓":"!"}),(0,b.jsxs)("div",{style:{flex:1},className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsx)("h3",{style:{fontSize:"16px",fontWeight:700,color:t[p]?.completed?"#3d5a2d":"#7f8c8d",marginBottom:"5px"},className:"jsx-11e0cc8a9ea0fe70",children:t[p]?.completed?"Danışan bu günü eksiksiz uyguladı!":"Bu gün için henüz onay verilmedi."}),t[p]?.note?(0,b.jsxs)("div",{style:{marginTop:"10px",padding:"15px",background:"white",borderRadius:"10px",fontSize:"14px",color:"#555",fontStyle:"italic",borderLeft:"4px solid #79a33d"},className:"jsx-11e0cc8a9ea0fe70",children:['"',t[p].note,'"']}):(0,b.jsx)("p",{style:{fontSize:"13px",color:"#95a5a6",marginTop:"5px"},className:"jsx-11e0cc8a9ea0fe70",children:"Danışan herhangi bir not bırakmadı."})]})]}),(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"30px"},className:"jsx-11e0cc8a9ea0fe70",children:["breakfast","lunch","dinner","snacks"].map(a=>(0,b.jsxs)("div",{style:{background:"white",padding:"30px",borderRadius:"20px",boxShadow:"0 10px 20px rgba(0,0,0,0.02)"},className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsx)("h3",{style:{fontSize:"18px",fontWeight:700,color:"#3d5a2d",textTransform:"capitalize"},className:"jsx-11e0cc8a9ea0fe70",children:"breakfast"===a?"Kahvaltı":"lunch"===a?"Öğle Yemeği":"dinner"===a?"Akşam Yemeği":"Ara Öğünler"}),(0,b.jsx)("button",{onClick:()=>{y(b=>b.map((b,c)=>{if(c===p){let c=b[a]||[];return{...b,[a]:[...c,{food:"",portion:"",cal:0}]}}return b}))},style:k,className:"jsx-11e0cc8a9ea0fe70",children:"+ Satır Ekle"})]}),(0,b.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsx)("thead",{className:"jsx-11e0cc8a9ea0fe70",children:(0,b.jsxs)("tr",{style:{textAlign:"left",fontSize:"13px",color:"#95a5a6",textTransform:"uppercase"},className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsx)("th",{style:{padding:"10px",width:"40%"},className:"jsx-11e0cc8a9ea0fe70",children:"Besin"}),(0,b.jsx)("th",{style:{padding:"10px",width:"30%"},className:"jsx-11e0cc8a9ea0fe70",children:"Porsiyon"}),(0,b.jsx)("th",{style:{padding:"10px",width:"20%"},className:"jsx-11e0cc8a9ea0fe70",children:"Kalori"}),(0,b.jsx)("th",{style:{padding:"10px",width:"10%"},className:"jsx-11e0cc8a9ea0fe70"})]})}),(0,b.jsxs)("tbody",{className:"jsx-11e0cc8a9ea0fe70",children:[(x[p][a]||[]).map((c,d)=>(0,b.jsxs)("tr",{className:"jsx-11e0cc8a9ea0fe70",children:[(0,b.jsx)("td",{style:{padding:"5px"},className:"jsx-11e0cc8a9ea0fe70",children:(0,b.jsx)("input",{value:c.food,onChange:b=>{var c;let e;return c=b.target.value,e=r.find(a=>a.name.toLowerCase()===String(c).toLowerCase()),void y(b=>b.map((b,f)=>{if(f===p){let f=[...b[a]||[]];return f[d]={...f[d],food:c},e&&(f[d].portion=e.unit,f[d].cal=e.cal),{...b,[a]:f}}return b}))},list:"food-suggestions",style:j,placeholder:"Besin adı...",className:"jsx-11e0cc8a9ea0fe70"})}),(0,b.jsx)("td",{style:{padding:"5px"},className:"jsx-11e0cc8a9ea0fe70",children:(0,b.jsx)("input",{value:c.portion,onChange:b=>z(a,d,"portion",b.target.value),style:j,placeholder:"100g, 1 porsiyon...",className:"jsx-11e0cc8a9ea0fe70"})}),(0,b.jsx)("td",{style:{padding:"5px"},className:"jsx-11e0cc8a9ea0fe70",children:(0,b.jsx)("input",{type:"number",value:c.cal,onChange:b=>z(a,d,"cal",b.target.value),style:j,className:"jsx-11e0cc8a9ea0fe70"})}),(0,b.jsx)("td",{style:{padding:"5px",textAlign:"center"},className:"jsx-11e0cc8a9ea0fe70",children:(0,b.jsx)("button",{onClick:()=>{y(b=>b.map((b,c)=>{if(c===p){let c=[...b[a]||[]];return c.splice(d,1),{...b,[a]:c}}return b}))},style:{background:"none",border:"none",color:"#e74c3c",cursor:"pointer",fontWeight:700},className:"jsx-11e0cc8a9ea0fe70",children:"Sil"})})]},d)),0===(x[p][a]||[]).length&&(0,b.jsx)("tr",{className:"jsx-11e0cc8a9ea0fe70",children:(0,b.jsx)("td",{colSpan:4,style:{padding:"20px",textAlign:"center",color:"#95a5a6",fontSize:"14px"},className:"jsx-11e0cc8a9ea0fe70",children:"Bu öğüne henüz besin eklenmedi."})})]})]})]},a))}),(0,b.jsx)("datalist",{id:"food-suggestions",className:"jsx-11e0cc8a9ea0fe70",children:r.map((a,c)=>(0,b.jsx)("option",{value:a.name,className:"jsx-11e0cc8a9ea0fe70"},c))})]})}):(0,b.jsx)("div",{children:"Hata: Danışan bulunamadı."})}let j={width:"100%",padding:"10px 15px",borderRadius:"8px",border:"1px solid #eee",fontSize:"14px",color:"#333",fontWeight:600},k={background:"none",border:"1px solid #79a33d",color:"#79a33d",padding:"8px 15px",borderRadius:"8px",fontWeight:700,cursor:"pointer"},l={background:"#79a33d",color:"white",border:"none",padding:"15px 40px",borderRadius:"10px",fontSize:"16px",fontWeight:700,cursor:"pointer",boxShadow:"0 10px 20px rgba(121, 163, 61, 0.2)"};a.s(["default",()=>i],9892)}];

//# sourceMappingURL=app_admin_clients_%5Bid%5D_diet_page_tsx_b11c6de7._.js.map