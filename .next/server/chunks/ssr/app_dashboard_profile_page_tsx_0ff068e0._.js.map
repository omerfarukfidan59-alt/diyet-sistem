{"version":3,"sources":["../../../../app/dashboard/profile/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { supabase } from \"../../../utils/supabase\";\r\n\r\nexport default function ProfilePage() {\r\n    const [formData, setFormData] = useState({\r\n        id: \"\",\r\n        name: \"\",\r\n        email: \"\",\r\n        height: \"\",\r\n        weight: \"\",\r\n        age: \"\",\r\n        targetWeight: \"\"\r\n    });\r\n    const [saved, setSaved] = useState(false);\r\n    const [loading, setLoading] = useState(false);\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        async function fetchProfile() {\r\n            const { data: authData } = await supabase.auth.getUser();\r\n            if (!authData.user) {\r\n                // Fallback / legacy check\r\n                const loggedInUser = localStorage.getItem(\"currentUser\");\r\n                if (loggedInUser) setFormData(JSON.parse(loggedInUser));\r\n                return;\r\n            }\r\n\r\n            const { data: profile } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('id', authData.user.id)\r\n                .single();\r\n\r\n            if (profile) {\r\n                setFormData({\r\n                    id: profile.id,\r\n                    name: profile.full_name,\r\n                    email: \"\", // Artık kullanılmıyor\r\n                    height: profile.height,\r\n                    weight: profile.weight,\r\n                    age: profile.age,\r\n                    targetWeight: profile.target_weight\r\n                });\r\n            }\r\n        }\r\n\r\n        fetchProfile();\r\n    }, []);\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setFormData({ ...formData, [e.target.name]: e.target.value });\r\n        setSaved(false);\r\n    };\r\n\r\n    const handleUpdate = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n\r\n        if (formData.id) {\r\n            // Supabase Update\r\n            const { error } = await supabase\r\n                .from('profiles')\r\n                .update({\r\n                    full_name: formData.name,\r\n                    height: Number(formData.height),\r\n                    weight: Number(formData.weight),\r\n                    age: Number(formData.age),\r\n                    target_weight: Number(formData.targetWeight)\r\n                })\r\n                .eq('id', formData.id);\r\n\r\n            if (error) {\r\n                alert(\"Güncelleme hatası: \" + error.message);\r\n                setLoading(false);\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Aktif oturumu güncelle (Fallback/Legacy cache)\r\n        localStorage.setItem(\"currentUser\", JSON.stringify(formData));\r\n\r\n        const users = JSON.parse(localStorage.getItem(\"users\") || \"[]\");\r\n        const updatedUsers = users.map((u: any) => u.id === (formData as any).id ? formData : u);\r\n        localStorage.setItem(\"users\", JSON.stringify(updatedUsers));\r\n\r\n        setSaved(true);\r\n        setLoading(false);\r\n        setTimeout(() => setSaved(false), 3000);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div style={{ flex: 1, padding: \"50px 20px\", display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\r\n                <div style={{ width: \"100%\", maxWidth: \"1000px\" }}>\r\n                    <div style={{ marginBottom: \"40px\", textAlign: \"center\" }}>\r\n                        <h1 style={{ fontSize: \"32px\", fontWeight: 700, color: \"#333\" }}>Hesap Ayarları</h1>\r\n                        <p style={{ color: \"#666\" }}>Profil bilgilerinizi ve fiziksel verilerinizi dilediğiniz zaman güncelleyebilirsiniz.</p>\r\n                    </div>\r\n\r\n                    <form onSubmit={handleUpdate} style={{ background: \"white\", padding: \"40px\", borderRadius: \"20px\", boxShadow: \"0 10px 40px rgba(0,0,0,0.04)\", display: \"flex\", flexDirection: \"column\", gap: \"30px\", width: \"100%\" }}>\r\n\r\n                        <div style={{ borderBottom: \"1px solid #f0f0f0\", paddingBottom: \"15px\" }}>\r\n                            <h3 style={{ fontSize: \"18px\", fontWeight: 700, color: \"#3d5a2d\" }}>Vücut Verilerini Güncelle</h3>\r\n                        </div>\r\n\r\n                        <div style={{\r\n                            display: \"grid\",\r\n                            gridTemplateColumns: \"repeat(auto-fit, minmax(200px, 1fr))\",\r\n                            gap: \"25px\",\r\n                            width: \"100%\"\r\n                        }} className=\"stats-grid-mobile\">\r\n                            <div style={inputGroup}>\r\n                                <label style={labelStyle}>Boy (cm)</label>\r\n                                <input type=\"number\" name=\"height\" value={formData.height} onChange={handleChange} style={inputStyle} />\r\n                            </div>\r\n                            <div style={inputGroup}>\r\n                                <label style={labelStyle}>Güncel Kilo (kg)</label>\r\n                                <input type=\"number\" name=\"weight\" value={formData.weight} onChange={handleChange} style={inputStyle} />\r\n                            </div>\r\n                            <div style={inputGroup}>\r\n                                <label style={labelStyle}>Yaş</label>\r\n                                <input type=\"number\" name=\"age\" value={formData.age} onChange={handleChange} style={inputStyle} />\r\n                            </div>\r\n                            <div style={inputGroup}>\r\n                                <label style={labelStyle}>Hedef Kilo (kg)</label>\r\n                                <input type=\"number\" name=\"targetWeight\" value={formData.targetWeight} onChange={handleChange} style={inputStyle} />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div style={{ display: \"flex\", alignItems: \"center\", gap: \"20px\", marginTop: \"20px\" }}>\r\n                            <button\r\n                                type=\"submit\"\r\n                                style={{\r\n                                    background: \"#79a33d\",\r\n                                    color: \"white\",\r\n                                    padding: \"15px 40px\",\r\n                                    borderRadius: \"10px\",\r\n                                    border: \"none\",\r\n                                    fontSize: \"16px\",\r\n                                    fontWeight: 700,\r\n                                    cursor: \"pointer\",\r\n                                    transition: \"all 0.3s ease\",\r\n                                    boxShadow: \"0 10px 20px rgba(121, 163, 61, 0.15)\"\r\n                                }}\r\n                                onMouseEnter={(e) => e.currentTarget.style.background = \"#3d5a2d\"}\r\n                                onMouseLeave={(e) => e.currentTarget.style.background = \"#79a33d\"}\r\n                            >\r\n                                Bilgileri Güncelle\r\n                            </button>\r\n\r\n                            {saved && (\r\n                                <span style={{ color: \"#27ae60\", fontWeight: 600, animation: \"fadeIn 0.5s\" }}>\r\n                                    Değişiklikler başarıyla kaydedildi!\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n\r\n            <style jsx>{`\r\n                @keyframes fadeIn {\r\n                    from { opacity: 0; transform: translateX(-10px); }\r\n                    to { opacity: 1; transform: translateX(0); }\r\n                }\r\n                @media (max-width: 1024px) {\r\n                    form { padding: 25px !important; }\r\n                    .stats-grid-mobile { grid-template-columns: 1fr !important; }\r\n                }\r\n            `}</style>\r\n        </>\r\n    );\r\n}\r\n\r\nconst inputGroup: React.CSSProperties = {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    gap: \"8px\"\r\n};\r\n\r\nconst labelStyle: React.CSSProperties = {\r\n    fontSize: \"14px\",\r\n    fontWeight: 700,\r\n    color: \"#555\"\r\n};\r\n\r\nconst inputStyle: React.CSSProperties = {\r\n    padding: \"14px 18px\",\r\n    borderRadius: \"10px\",\r\n    border: \"1px solid #e0e0e0\",\r\n    outline: \"none\",\r\n    fontSize: \"15px\",\r\n    color: \"#333\",\r\n    fontWeight: 600,\r\n    transition: \"border-color 0.3s\",\r\n    background: \"#fff\"\r\n};\r\n\r\n"],"names":[],"mappings":"qEAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEe,SAAS,IACpB,GAAM,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACrC,GAAI,GACJ,KAAM,GACN,MAAO,GACP,OAAQ,GACR,OAAQ,GACR,IAAK,GACL,aAAc,EAClB,GACM,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC7B,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACxB,CAAA,EAAA,EAAA,SAAA,AAAS,IAExB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,MACN,AA4BA,eA5Be,EACX,GAAM,CAAE,KAAM,CAAQ,CAAE,CAAG,MAAM,EAAA,QAAQ,CAAC,IAAI,CAAC,OAAO,GACtD,GAAI,CAAC,EAAS,IAAI,CAAE,CAEhB,IAAM,EAAe,aAAa,OAAO,CAAC,eACtC,GAAc,EAAY,KAAK,KAAK,CAAC,IACzC,MACJ,CAEA,GAAM,CAAE,KAAM,CAAO,CAAE,CAAG,MAAM,EAAA,QAAQ,CACnC,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,KAAM,EAAS,IAAI,CAAC,EAAE,EACzB,MAAM,GAEP,GACA,EAAY,CACR,GAFK,AAED,EAAQ,EAAE,CACd,KAAM,EAAQ,SAAS,CACvB,MAAO,GACP,OAAQ,EAAQ,MAAM,CACtB,OAAQ,EAAQ,MAAM,CACtB,IAAK,EAAQ,GAAG,CAChB,aAAc,EAAQ,aAAa,AACvC,EAER,GAGJ,EAAG,EAAE,EAEL,IAAM,EAAe,AAAC,IAClB,EAAY,CAAE,GAAG,CAAQ,CAAE,CAAC,EAAE,MAAM,CAAC,IAAI,CAAC,CAAE,EAAE,MAAM,CAAC,KAAK,AAAC,GAC3D,GAAS,EACb,EAEM,EAAe,MAAO,IAIxB,GAHA,EAAE,cAAc,GAChB,GAAW,GAEP,EAAS,EAAE,CAAE,CAEb,GAAM,OAAE,CAAK,CAAE,CAAG,MAAM,EAAA,QAAQ,CAC3B,IAAI,CAAC,YACL,MAAM,CAAC,CACJ,UAAW,EAAS,IAAI,CACxB,OAAQ,OAAO,EAAS,MAAM,EAC9B,OAAQ,OAAO,EAAS,MAAM,EAC9B,IAAK,OAAO,EAAS,GAAG,EACxB,cAAe,OAAO,EAAS,YAAY,CAC/C,GACC,EAAE,CAAC,KAAM,EAAS,EAAE,EAEzB,GAAI,EAAO,CACP,MAAM,sBAAwB,EAAM,OAAO,EAC3C,GAAW,GACX,MACJ,CACJ,CAGA,aAAa,OAAO,CAAC,cAAe,KAAK,SAAS,CAAC,IAGnD,IAAM,EADQ,AACO,KADF,KAAK,CAAC,aAAa,OAAO,CAAC,UAAY,MAC/B,GAAG,CAAC,AAAC,GAAW,EAAE,EAAE,GAAM,EAAiB,EAAE,CAAG,EAAW,GACtF,aAAa,OAAO,CAAC,QAAS,KAAK,SAAS,CAAC,IAE7C,GAAS,GACT,GAAW,GACX,WAAW,IAAM,GAAS,GAAQ,IACtC,EAEA,MACI,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,MAAO,CAAE,KAAM,EAAG,QAAS,YAAa,QAAS,OAAQ,cAAe,SAAU,WAAY,QAAS,4CACxG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,MAAO,OAAQ,SAAU,QAAS,6CAC5C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,aAAc,OAAQ,UAAW,QAAS,6CACpD,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,MAAO,CAAE,SAAU,OAAQ,WAAY,IAAK,MAAO,MAAO,4CAAG,mBACjE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,MAAO,CAAE,MAAO,MAAO,4CAAG,6FAGjC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAAU,EAAc,MAAO,CAAE,WAAY,QAAS,QAAS,OAAQ,aAAc,OAAQ,UAAW,+BAAgC,QAAS,OAAQ,cAAe,SAAU,IAAK,OAAQ,MAAO,MAAO,6CAE/M,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,MAAO,CAAE,aAAc,oBAAqB,cAAe,MAAO,4CACnE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,MAAO,CAAE,SAAU,OAAQ,WAAY,IAAK,MAAO,SAAU,4CAAG,gCAGxE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CACR,QAAS,OACT,oBAAqB,uCACrB,IAAK,OACL,MAAO,MACX,2CAAa,oBACT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,6CACR,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,MAAO,4CAAY,aAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,SAAS,KAAK,SAAS,MAAO,EAAS,MAAM,CAAE,SAAU,EAAc,MAAO,wCAE9F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,6CACR,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,MAAO,4CAAY,qBAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,SAAS,KAAK,SAAS,MAAO,EAAS,MAAM,CAAE,SAAU,EAAc,MAAO,wCAE9F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,6CACR,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,MAAO,4CAAY,QAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,SAAS,KAAK,MAAM,MAAO,EAAS,GAAG,CAAE,SAAU,EAAc,MAAO,wCAExF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,6CACR,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,MAAO,4CAAY,oBAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,SAAS,KAAK,eAAe,MAAO,EAAS,YAAY,CAAE,SAAU,EAAc,MAAO,2CAI9G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,OAAQ,UAAW,MAAO,6CAChF,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,KAAK,SACL,MAAO,CACH,WAAY,UACZ,MAAO,QACP,QAAS,YACT,aAAc,OACd,OAAQ,OACR,SAAU,OACV,WAAY,IACZ,OAAQ,UACR,WAAY,gBACZ,UAAW,sCACf,EACA,aAAc,AAAC,GAAM,EAAE,aAAa,CAAC,KAAK,CAAC,UAAU,CAAG,UACxD,aAAc,AAAC,GAAM,EAAE,aAAa,CAAC,KAAK,CAAC,UAAU,CAAG,oDAC3D,uBAIA,GACG,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,MAAO,CAAE,MAAO,UAAW,WAAY,IAAK,UAAW,aAAc,4CAAG,kWAqB9G,CAEA,IAAM,EAAkC,CACpC,QAAS,OACT,cAAe,SACf,IAAK,KACT,EAEM,EAAkC,CACpC,SAAU,OACV,WAAY,IACZ,MAAO,MACX,EAEM,EAAkC,CACpC,QAAS,YACT,aAAc,OACd,OAAQ,oBACR,QAAS,OACT,SAAU,OACV,MAAO,OACP,WAAY,IACZ,WAAY,oBACZ,WAAY,MAChB"}