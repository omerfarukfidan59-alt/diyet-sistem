{"version":3,"sources":["../../../../app/admin/clients/%5Bid%5D/diet/page.tsx","../../../../utils/calorieCalculator.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { supabase } from \"../../../../../utils/supabase\";\r\nimport { calculateCalories } from \"../../../../../utils/calorieCalculator\";\r\n\r\nexport default function DietAssignmentPage() {\r\n    const params = useParams();\r\n    const router = useRouter();\r\n    const userId = params?.id;\r\n\r\n    const [client, setClient] = useState<any>(null);\r\n    const [activeDay, setActiveDay] = useState(0);\r\n    const [foods, setFoods] = useState<any[]>([]);\r\n    const [progress, setProgress] = useState<{ [day: number]: { completed: boolean, note: string } }>({});\r\n    const [loading, setLoading] = useState(true);\r\n    const [diet, setDiet] = useState<any[]>([\r\n        {\r\n            day: 1,\r\n            breakfast: [],\r\n            lunch: [],\r\n            dinner: [],\r\n            snacks: []\r\n        }\r\n    ]);\r\n\r\n    useEffect(() => {\r\n        if (!userId) return;\r\n\r\n        async function fetchData() {\r\n            setLoading(true);\r\n\r\n            // 1. Danışan Profilini Çek\r\n            const { data: profile } = await supabase\r\n                .from('profiles')\r\n                .select('*')\r\n                .eq('id', userId)\r\n                .single();\r\n\r\n            if (profile) setClient(profile);\r\n\r\n            // 2. Mevcut Diyeti Çek\r\n            const { data: dietData } = await supabase\r\n                .from('diets')\r\n                .select('*')\r\n                .eq('client_id', userId)\r\n                .eq('is_active', true)\r\n                .maybeSingle();\r\n\r\n            if (dietData && dietData.content) {\r\n                setDiet(dietData.content);\r\n            }\r\n\r\n            // 3. Besin Kütüphanesini Çek\r\n            const { data: foodData } = await supabase\r\n                .from('food_library')\r\n                .select('*');\r\n\r\n            if (foodData) setFoods(foodData);\r\n\r\n            // 4. İlerlemeyi Çek\r\n            const { data: progressData } = await supabase\r\n                .from('diet_progress')\r\n                .select('*')\r\n                .eq('client_id', userId);\r\n\r\n            if (progressData) {\r\n                const progObj: any = {};\r\n                progressData.forEach(p => {\r\n                    progObj[p.day_number - 1] = { completed: p.is_completed, note: p.note };\r\n                });\r\n                setProgress(progObj);\r\n            }\r\n\r\n            setLoading(false);\r\n        }\r\n\r\n        fetchData();\r\n    }, [userId]);\r\n\r\n    const addDay = () => {\r\n        setDiet([\r\n            ...diet,\r\n            {\r\n                day: diet.length + 1,\r\n                breakfast: [],\r\n                lunch: [],\r\n                dinner: [],\r\n                snacks: []\r\n            }\r\n        ]);\r\n        setActiveDay(diet.length);\r\n    };\r\n\r\n    const removeDay = (indexToRemove: number) => {\r\n        if (diet.length === 1) return alert(\"En az 1 gün olmalı!\");\r\n        const newDiet = diet.filter((_, idx) => idx !== indexToRemove).map((d, idx) => ({ ...d, day: idx + 1 }));\r\n        setDiet(newDiet);\r\n        setActiveDay(Math.min(activeDay, newDiet.length - 1));\r\n    };\r\n\r\n    const addRow = (meal: string) => {\r\n        setDiet(prevDiet => prevDiet.map((d, index) => {\r\n            if (index === activeDay) {\r\n                const existingMeals = (d as any)[meal] || [];\r\n                return {\r\n                    ...d,\r\n                    [meal]: [...existingMeals, { food: \"\", portion: \"\", cal: 0 }]\r\n                };\r\n            }\r\n            return d;\r\n        }));\r\n    };\r\n\r\n    const updateRow = (meal: string, index: number, field: string, value: any) => {\r\n        setDiet(prevDiet => prevDiet.map((d, dayIndex) => {\r\n            if (dayIndex === activeDay) {\r\n                const newMealArr = [...((d as any)[meal] || [])];\r\n                newMealArr[index] = { ...newMealArr[index], [field]: value };\r\n\r\n                // If portion is updated, try to auto-calculate calories\r\n                if (field === \"portion\") {\r\n                    const currentFoodName = newMealArr[index].food;\r\n                    const baseFood = foods.find(f => f.name === currentFoodName);\r\n\r\n                    if (baseFood) {\r\n                        const calculatedCal = calculateCalories(String(value), baseFood);\r\n                        if (calculatedCal !== null) {\r\n                            newMealArr[index].cal = calculatedCal;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return { ...d, [meal]: newMealArr };\r\n            }\r\n            return d;\r\n        }));\r\n    };\r\n\r\n    const handleFoodChange = (meal: string, index: number, value: string) => {\r\n        const selectedFood = foods.find(f => f.name === value);\r\n\r\n        setDiet(prevDiet => prevDiet.map((d, dayIndex) => {\r\n            if (dayIndex === activeDay) {\r\n                const newMealArr = [...((d as any)[meal] || [])];\r\n                newMealArr[index] = { ...newMealArr[index], food: value };\r\n\r\n                if (selectedFood) {\r\n                    newMealArr[index].portion = selectedFood.unit;\r\n                    newMealArr[index].cal = selectedFood.cal;\r\n                }\r\n\r\n                return { ...d, [meal]: newMealArr };\r\n            }\r\n            return d;\r\n        }));\r\n    };\r\n\r\n    const removeRow = (meal: string, index: number) => {\r\n        setDiet(prevDiet => prevDiet.map((d, dayIndex) => {\r\n            if (dayIndex === activeDay) {\r\n                const newMealArr = [...((d as any)[meal] || [])];\r\n                newMealArr.splice(index, 1);\r\n                return { ...d, [meal]: newMealArr };\r\n            }\r\n            return d;\r\n        }));\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        if (!userId) return;\r\n        setLoading(true);\r\n\r\n        // Önce eski aktif diyetleri pasife çek (İsteğe bağlı, biz burada tek bir aktif diyet tutuyoruz)\r\n        await supabase\r\n            .from('diets')\r\n            .update({ is_active: false })\r\n            .eq('client_id', userId);\r\n\r\n        // Yeni diyeti ekle\r\n        const { error } = await supabase\r\n            .from('diets')\r\n            .insert([{\r\n                client_id: userId,\r\n                title: `${diet.length} Günlük Program`,\r\n                content: diet,\r\n                is_active: true\r\n            }]);\r\n\r\n        if (error) {\r\n            alert(\"Diyet kaydedilemedi: \" + error.message);\r\n        } else {\r\n            alert(\"Diyet listesi Supabase'e başarıyla kaydedildi!\");\r\n            router.push(\"/admin/clients\");\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    if (loading) return <div>Veriler yükleniyor...</div>;\r\n    if (!client || !diet[activeDay]) return <div>Hata: Danışan bulunamadı.</div>;\r\n\r\n    return (\r\n        <>\r\n            {/* Diet Assignment wrapper responsive padding */}\r\n            <div className=\"diet-page-wrapper\" style={{ flex: 1, display: \"flex\", flexDirection: \"column\" }}>\r\n                <style jsx>{`\r\n                    .diet-page-wrapper {\r\n                        padding: 50px;\r\n                    }\r\n                    @media (max-width: 1024px) {\r\n                        .diet-page-wrapper {\r\n                            padding: 20px;\r\n                        }\r\n                    }\r\n                `}</style>\r\n\r\n\r\n                <div style={{ marginBottom: \"40px\" }}>\r\n                    <Link href=\"/admin/clients\" style={{ color: \"#79a33d\", textDecoration: \"none\", fontSize: \"14px\", fontWeight: 700 }}>← Listeye Dön</Link>\r\n                    <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginTop: \"10px\" }}>\r\n                        <div>\r\n                            <h1 style={{ fontSize: \"32px\", fontWeight: 700, color: \"#2c3e50\" }}>Diyet Hazırla: {client.name}</h1>\r\n                            <p style={{ color: \"#7f8c8d\" }}>Danışan için öğün detaylarını gün gün planlayabilirsiniz.</p>\r\n                        </div>\r\n                        <button onClick={handleSave} style={saveBtn}>Diyet Listesini {diet.length} Günlük Kaydet</button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Day Navigation Tabs */}\r\n                <div style={{ display: \"flex\", gap: \"10px\", marginBottom: \"25px\", overflowX: \"auto\", paddingBottom: \"10px\" }}>\r\n                    {diet.map((d, idx) => (\r\n                        <div key={idx} style={{ position: \"relative\" }}>\r\n                            <button\r\n                                onClick={() => setActiveDay(idx)}\r\n                                style={{\r\n                                    padding: \"12px 25px\",\r\n                                    background: activeDay === idx ? \"#79a33d\" : \"white\",\r\n                                    color: activeDay === idx ? \"white\" : \"#2c3e50\",\r\n                                    border: `1px solid ${activeDay === idx ? \"#79a33d\" : \"#e0e0e0\"} `,\r\n                                    borderRadius: \"10px\",\r\n                                    fontWeight: 700,\r\n                                    cursor: \"pointer\",\r\n                                    transition: \"all 0.2s\"\r\n                                }}\r\n                            >\r\n                                {idx + 1}. Gün\r\n                            </button>\r\n                            {diet.length > 1 && (\r\n                                <button\r\n                                    onClick={() => removeDay(idx)}\r\n                                    style={{\r\n                                        position: \"absolute\",\r\n                                        top: \"-8px\",\r\n                                        right: \"-8px\",\r\n                                        background: \"#e74c3c\",\r\n                                        color: \"white\",\r\n                                        border: \"none\",\r\n                                        borderRadius: \"50%\",\r\n                                        width: \"22px\",\r\n                                        height: \"22px\",\r\n                                        fontSize: \"10px\",\r\n                                        cursor: \"pointer\",\r\n                                        display: \"flex\",\r\n                                        alignItems: \"center\",\r\n                                        justifyContent: \"center\"\r\n                                    }}\r\n                                    title=\"Günü Sil\"\r\n                                >\r\n                                    X\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    ))}\r\n                    <button\r\n                        onClick={addDay}\r\n                        style={{\r\n                            padding: \"12px 25px\",\r\n                            background: \"transparent\",\r\n                            color: \"#79a33d\",\r\n                            border: \"2px dashed #79a33d\",\r\n                            borderRadius: \"10px\",\r\n                            fontWeight: 700,\r\n                            cursor: \"pointer\"\r\n                        }}\r\n                    >\r\n                        + Yeni Gün Ekle\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Danışan Geri Bildirimi Panosu */}\r\n                <div style={{ marginBottom: \"30px\", background: progress[activeDay]?.completed ? \"#eaf2e3\" : \"white\", padding: \"20px 30px\", borderRadius: \"15px\", border: `1px solid ${progress[activeDay]?.completed ? \"#79a33d\" : \"#eee\"} `, display: \"flex\", alignItems: \"flex-start\", gap: \"20px\" }}>\r\n                    <div style={{\r\n                        fontSize: \"24px\",\r\n                        background: progress[activeDay]?.completed ? \"#79a33d\" : \"#f0f0f0\",\r\n                        color: progress[activeDay]?.completed ? \"white\" : \"#ccc\",\r\n                        width: \"50px\",\r\n                        height: \"50px\",\r\n                        borderRadius: \"50%\",\r\n                        display: \"flex\",\r\n                        alignItems: \"center\",\r\n                        justifyContent: \"center\"\r\n                    }}>\r\n                        {progress[activeDay]?.completed ? \"✓\" : \"!\"}\r\n                    </div>\r\n                    <div style={{ flex: 1 }}>\r\n                        <h3 style={{ fontSize: \"16px\", fontWeight: 700, color: progress[activeDay]?.completed ? \"#3d5a2d\" : \"#7f8c8d\", marginBottom: \"5px\" }}>\r\n                            {progress[activeDay]?.completed ? \"Danışan bu günü eksiksiz uyguladı!\" : \"Bu gün için henüz onay verilmedi.\"}\r\n                        </h3>\r\n                        {progress[activeDay]?.note ? (\r\n                            <div style={{ marginTop: \"10px\", padding: \"15px\", background: \"white\", borderRadius: \"10px\", fontSize: \"14px\", color: \"#555\", fontStyle: \"italic\", borderLeft: \"4px solid #79a33d\" }}>\r\n                                \"{progress[activeDay].note}\"\r\n                            </div>\r\n                        ) : (\r\n                            <p style={{ fontSize: \"13px\", color: \"#95a5a6\", marginTop: \"5px\" }}>Danışan herhangi bir not bırakmadı.</p>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{ display: \"flex\", flexDirection: \"column\", gap: \"30px\" }}>\r\n\r\n                    {[\"breakfast\", \"lunch\", \"dinner\", \"snacks\"].map((meal) => (\r\n                        <div key={meal} style={{ background: \"white\", padding: \"30px\", borderRadius: \"20px\", boxShadow: \"0 10px 20px rgba(0,0,0,0.02)\" }}>\r\n                            <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: \"20px\" }}>\r\n                                <h3 style={{ fontSize: \"18px\", fontWeight: 700, color: \"#3d5a2d\", textTransform: \"capitalize\" }}>\r\n                                    {meal === \"breakfast\" ? \"Kahvaltı\" : meal === \"lunch\" ? \"Öğle Yemeği\" : meal === \"dinner\" ? \"Akşam Yemeği\" : \"Ara Öğünler\"}\r\n                                </h3>\r\n                                <button onClick={() => addRow(meal)} style={addBtn}>+ Satır Ekle</button>\r\n                            </div>\r\n\r\n                            <table style={{ width: \"100%\", borderCollapse: \"collapse\" }}>\r\n                                <thead>\r\n                                    <tr style={{ textAlign: \"left\", fontSize: \"13px\", color: \"#95a5a6\", textTransform: \"uppercase\" }}>\r\n                                        <th style={{ padding: \"10px\", width: \"40%\" }}>Besin</th>\r\n                                        <th style={{ padding: \"10px\", width: \"30%\" }}>Porsiyon</th>\r\n                                        <th style={{ padding: \"10px\", width: \"20%\" }}>Kalori</th>\r\n                                        <th style={{ padding: \"10px\", width: \"10%\" }}></th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    {((diet[activeDay] as any)[meal] || []).map((row: any, idx: number) => (\r\n                                        <tr key={idx}>\r\n                                            <td style={{ padding: \"5px\" }}>\r\n                                                <input value={row.food} onChange={e => handleFoodChange(meal, idx, e.target.value)} list=\"food-suggestions\" style={inputStyle} placeholder=\"Besin adı...\" />\r\n                                            </td>\r\n                                            <td style={{ padding: \"5px\" }}>\r\n                                                <input value={row.portion} onChange={e => updateRow(meal, idx, \"portion\", e.target.value)} style={inputStyle} placeholder=\"100g, 1 porsiyon...\" />\r\n                                            </td>\r\n                                            <td style={{ padding: \"5px\" }}>\r\n                                                <input type=\"number\" value={row.cal} onChange={e => updateRow(meal, idx, \"cal\", e.target.value)} style={inputStyle} />\r\n                                            </td>\r\n                                            <td style={{ padding: \"5px\", textAlign: \"center\" }}>\r\n                                                <button onClick={() => removeRow(meal, idx)} style={{ background: \"none\", border: \"none\", color: \"#e74c3c\", cursor: \"pointer\", fontWeight: 700 }}>Sil</button>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                    {((diet[activeDay] as any)[meal] || []).length === 0 && (\r\n                                        <tr>\r\n                                            <td colSpan={4} style={{ padding: \"20px\", textAlign: \"center\", color: \"#95a5a6\", fontSize: \"14px\" }}>\r\n                                                Bu öğüne henüz besin eklenmedi.\r\n                                            </td>\r\n                                        </tr>\r\n                                    )}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                <datalist id=\"food-suggestions\">\r\n                    {foods.map((food, idx) => (\r\n                        <option key={idx} value={food.name} />\r\n                    ))}\r\n                </datalist>\r\n\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nconst inputStyle = {\r\n    width: \"100%\",\r\n    padding: \"10px 15px\",\r\n    borderRadius: \"8px\",\r\n    border: \"1px solid #eee\",\r\n    fontSize: \"14px\",\r\n    color: \"#333\",\r\n    fontWeight: 600\r\n};\r\n\r\nconst addBtn = {\r\n    background: \"none\",\r\n    border: \"1px solid #79a33d\",\r\n    color: \"#79a33d\",\r\n    padding: \"8px 15px\",\r\n    borderRadius: \"8px\",\r\n    fontWeight: 700,\r\n    cursor: \"pointer\"\r\n};\r\n\r\nconst saveBtn = {\r\n    background: \"#79a33d\",\r\n    color: \"white\",\r\n    border: \"none\",\r\n    padding: \"15px 40px\",\r\n    borderRadius: \"10px\",\r\n    fontSize: \"16px\",\r\n    fontWeight: 700,\r\n    cursor: \"pointer\",\r\n    boxShadow: \"0 10px 20px rgba(121, 163, 61, 0.2)\"\r\n};\r\n","export function parseUnitAndAmount(input: string): { amount: number, unit: string } | null {\r\n    if (!input || typeof input !== \"string\") return null;\r\n\r\n    // Replace commas with dots for decimal parsing\r\n    const sanitized = input.trim().replace(',', '.');\r\n\r\n    // Match numeric prefix and string suffix (e.g., \"150 gram\", \"1.5\", \"2 adet\")\r\n    const match = sanitized.match(/^([\\d.]+)\\s*(.*)?$/);\r\n\r\n    if (!match) return null;\r\n\r\n    const amount = parseFloat(match[1]);\r\n    if (isNaN(amount)) return null;\r\n\r\n    let unit = (match[2] || \"\").toLowerCase().trim();\r\n\r\n    // Normalize common aliases\r\n    if ([\"g\", \"gr\", \"gram\"].includes(unit)) {\r\n        unit = \"gram\";\r\n    } else if ([\"adet\", \"tane\"].includes(unit)) {\r\n        unit = \"adet\";\r\n    }\r\n\r\n    return { amount, unit };\r\n}\r\n\r\nexport function calculateCalories(\r\n    enteredPortion: string,\r\n    baseFood: { unit: string, cal: number | string }\r\n): number | null {\r\n    if (!enteredPortion || !baseFood || !baseFood.unit || baseFood.cal === undefined) return null;\r\n\r\n    const entered = parseUnitAndAmount(enteredPortion);\r\n    const base = parseUnitAndAmount(String(baseFood.unit));\r\n\r\n    if (!entered || !base || base.amount === 0) return null;\r\n\r\n    const baseCal = Number(baseFood.cal);\r\n    if (isNaN(baseCal)) return null;\r\n\r\n    let unitsMatch = false;\r\n\r\n    // If the units exactly match, or the user just entered a number without a unit (assuming the original unit)\r\n    if (entered.unit === base.unit || entered.unit === \"\") {\r\n        unitsMatch = true;\r\n    }\r\n    // If the user enters a unit but the base unit didn't have one (e.g. base: \"1\", entered: \"1.5 porsiyon\")\r\n    else if (base.unit === \"\") {\r\n        unitsMatch = true;\r\n    }\r\n\r\n    // Prevent comparing mismatched units like \"100 gram\" vs \"2 adet\"\r\n    if (!unitsMatch) return null;\r\n\r\n    const ratio = entered.amount / base.amount;\r\n    const calculatedCal = Math.round(baseCal * ratio);\r\n\r\n    return calculatedCal;\r\n}\r\n"],"names":[],"mappings":"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"}